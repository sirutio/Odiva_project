{% extends "index.html" %}

{% block section %}
<style>
    body {
        background-color: #f6f7f9; /* ë°°ê²½ìƒ‰ì´ ìˆì–´ì•¼ í°ìƒ‰ ë°•ìŠ¤ê°€ ë‹ë³´ì…ë‹ˆë‹¤ */
    }

    .history-container {
        width: 90%;             /* ëª¨ë°”ì¼ì—ì„œëŠ” ê½‰ ì°¨ê²Œ */
        max-width: 600px;       /* PCì—ì„œëŠ” ë„ˆë¬´ ë„“ì§€ ì•Šê²Œ (800px -> 600px ì¶•ì†Œ) */
        min-height: 600px;      /* ë‚´ìš©ì´ ì—†ì–´ë„ ìµœì†Œ ì´ë§Œí¼ ê¸¸ê²Œ ìœ ì§€ (ì˜ë¦° ëŠë‚Œ ë°©ì§€) */
        
        margin: 50px auto;
        padding: 40px;          /* ì•ˆìª½ ì—¬ë°±ì„ ë„‰ë„‰í•˜ê²Œ */
        
        background-color: white;
        border-radius: 20px;    /* ëª¨ì„œë¦¬ë¥¼ ë” ë‘¥ê¸€ê²Œ */
        box-shadow: 0 4px 15px rgba(0,0,0,0.05); /* ê·¸ë¦¼ìë¥¼ ì€ì€í•˜ê²Œ */
    }

    /* ì œëª© ìŠ¤íƒ€ì¼ */
    .history-container h2 {
        text-align: center;
        font-size: 24px;
        margin-bottom: 10px;
        color: #333;
    }

    .history-container hr {
        border: 0;
        height: 1px;
        background: #eee;
        margin-bottom: 30px;
    }

    /* ì´ˆë¡ìƒ‰ ë‘¥ê·¼ ì•Œë¦¼ì°½ (ì´ì „ ìš”ì²­ ë°˜ì˜) */
    .refund-notice {
        background-color: rgb(0, 70, 42);
        color: white;
        font-weight: bold;
        font-size: 14px;        /* ê¸€ì”¨ í¬ê¸° ì‚´ì§ ì¡°ì • */
        
        border-radius: 50px;    /* ìº¡ìŠ ëª¨ì–‘ */
        padding: 10px 30px;
        
        width: fit-content;
        margin: 0 auto 40px auto; /* ì•„ë˜ ì—¬ë°±ì„ ë” ì¤˜ì„œ ì‹œì›í•˜ê²Œ */
        box-shadow: 0 4px 10px rgba(0, 70, 42, 0.2);
    }

    /* ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ìŠ¤íƒ€ì¼ */
    .order-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 0;
        border-bottom: 1px solid #f0f0f0; /* ì•„ì£¼ ì—°í•œ íšŒìƒ‰ */
    }
    .order-item:last-child {
        border-bottom: none;
    }

    .order-info h3 { 
        margin: 0 0 5px 0; 
        font-size: 18px; 
    }
    .order-info p { 
        margin: 0; 
        color: #666; 
        font-size: 15px;
    }
    
    .btn-cancel {
        background-color: #fff;
        color: #e74c3c;
        border: 1px solid #e74c3c;
        padding: 6px 14px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 13px;
        font-weight: bold;
        transition: all 0.2s;
    }
    .btn-cancel:hover { 
        background-color: #e74c3c; 
        color: white;
    }

    /* [ìˆ˜ì •] ë‚´ì—­ ì—†ìŒ ì•ˆë‚´ ìŠ¤íƒ€ì¼ */
    .no-orders { 
        text-align: center; 
        margin-top: 100px;      /* ìœ„ìª½ ì—¬ë°±ì„ ë§ì´ ì¤˜ì„œ ì¤‘ì•™ ì¯¤ì— ì˜¤ê²Œ */
        color: #aaa;            /* ì—°í•œ íšŒìƒ‰ìœ¼ë¡œ ë³€ê²½ */
    }

    .no-orders p {
        font-size: 15px;        /* ê¸€ì”¨ í¬ê¸° ì¶•ì†Œ (ìš”ì²­ì‚¬í•­) */
        font-weight: normal;
    }
    
    /* ì•„ì´ì½˜ ì¶”ê°€ (ì„ íƒì‚¬í•­) */
    .no-orders span {
        display: block;
        font-size: 40px;
        margin-bottom: 10px;
        opacity: 0.3;
    }
</style>

<div class="history-container">
    <h2>ê²°ì œ ë‚´ì—­</h2>
    <hr>
    
    <div class="refund-notice">
        !! êµ¬ë§¤ 3ì¼ ë‚´ì—ë§Œ í™˜ë¶ˆ ê°€ëŠ¥ !!
    </div>

    {% if orders %}
        {% for order in orders %}
        <div class="order-item">
            <div class="order-info">
                <h3>{{ order.name }}</h3>
                <p>ê°€ê²©: {{ order.price }}ì›</p>
            </div>
            <button class="btn-cancel" onclick="cancelOrder('{{ order.name }}')">êµ¬ë§¤ ì·¨ì†Œ</button>
        </div>
        {% endfor %}
    {% else %}
        <div class="no-orders">
            <span>ğŸ“¦</span> <p>ì•„ì§ êµ¬ë§¤í•œ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        </div>
    {% endif %}
</div>

<script>
function cancelOrder(name) {
    if (confirm("ì •ë§ '" + name + "' ìƒí’ˆì˜ êµ¬ë§¤ë¥¼ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
        $.ajax({
            type: "POST",
            url: "/cancel_order",
            data: { name: name },
            success: function(response) {
                alert(response.msg);
                window.location.reload(); // ìƒˆë¡œê³ ì¹¨í•´ì„œ ëª©ë¡ ê°±ì‹ 
            },
            error: function() {
                alert("ì·¨ì†Œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            }
        });
    }
}
</script>
{% endblock %}