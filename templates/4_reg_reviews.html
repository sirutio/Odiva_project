{% extends "index.html" %}

{% block style %}
<style>
    /* --- ë³€ìˆ˜ ì„¤ì • --- */
    :root {
        --bg: #f6f7f9;
        --surface: #fff;
        --muted: #6b7280;
        --text: #1f2937;
        --border: #e5e7eb;
        --primary: rgb(0, 70, 42);
        --radius: 20px; 
        --shadow: 0 10px 30px rgba(0, 0, 0, .08); 
    }

    /* --- ë ˆì´ì•„ì›ƒ (ì‚¬ì´ì¦ˆ UP) --- */
    .review-container {
        max-width: 1200px; /* ë„ˆë¹„ í™•ëŒ€ */
        margin: 0 auto;
        padding: 60px 20px;
    }

    .page-title {
        font-size: 32px; /* ì œëª© í¬ê¸° í™•ëŒ€ */
        font-weight: bold;
        margin-bottom: 30px;
        color: #1f2937;
    }

    .back-link {
        display: inline-block;
        margin-bottom: 15px;
        color: var(--muted);
        text-decoration: none;
        font-size: 16px; /* ë§í¬ ê¸€ì”¨ í™•ëŒ€ */
    }
    .back-link:hover { text-decoration: underline; }

    /* --- ì¹´ë“œ ìŠ¤íƒ€ì¼ --- */
    .card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: 50px; /* ë‚´ë¶€ ì—¬ë°± í™•ëŒ€ */
    }

    /* --- ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ (ì¢Œìš° ë¶„í• ) --- */
    .grid {
        display: grid;
        grid-template-columns: 1fr 1fr; /* 1:1 ë¹„ìœ¨ */
        gap: 50px; /* ì¢Œìš° ê°„ê²© í™•ëŒ€ */
    }

    .col {
        display: flex;
        flex-direction: column;
        gap: 25px; /* ìš”ì†Œ ê°„ ê°„ê²© í™•ëŒ€ */
    }

    /* --- ì…ë ¥ ìš”ì†Œ ìŠ¤íƒ€ì¼ (ì‚¬ì´ì¦ˆ UP) --- */
    label {
        display: block;
        font-size: 18px; /* ë¼ë²¨ ê¸€ì”¨ í™•ëŒ€ */
        font-weight: 700;
        color: #374151;
        margin-bottom: 10px;
    }

    input[type="text"],
    textarea {
        width: 100%;
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 16px; /* ì…ë ¥ì°½ ë‚´ë¶€ ì—¬ë°± í™•ëŒ€ */
        background: #fafafa;
        outline: none;
        font-size: 16px; /* ì…ë ¥ ê¸€ì”¨ í™•ëŒ€ */
        font-family: inherit;
        box-sizing: border-box;
    }

    input[type="text"]:focus, textarea:focus {
        border-color: #c7c9d1;
        background: #fff;
    }
    
    input[readonly] {
        background-color: #f1f3f5;
        color: #555;
        font-weight: 600;
        cursor: not-allowed;
    }

    textarea {
        height: 100%; 
        min-height: 550px; /* í…ìŠ¤íŠ¸ ë°•ìŠ¤ ë†’ì´ í™•ëŒ€ */
        resize: vertical;
        line-height: 1.6;
    }

    /* --- ì´ë¯¸ì§€ ì¸ë„¤ì¼ ë°•ìŠ¤ (ì‚¬ì´ì¦ˆ UP) --- */
    .product-thumb {
        position: relative;
        width: 100%;
        height: 350px; /* ì´ë¯¸ì§€ ë°•ìŠ¤ ë†’ì´ ëŒ€í­ í™•ëŒ€ */
        border: 2px dashed #d1d5db; /* í…Œë‘ë¦¬ ì¡°ê¸ˆ ë” ì§„í•˜ê²Œ */
        border-radius: 16px;
        background: #f8f9fa;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .product-thumb img {
        width: 100%;
        height: 100%;
        object-fit: cover; /* ë°•ìŠ¤ ê½‰ ì±„ìš°ê¸° */
        display: none;
    }

    .product-thumb .placeholder {
        color: #9aa3ad;
        font-size: 16px;
        font-weight: 500;
    }
    
    .product-thumb.has-img img { display: block; }
    .product-thumb.has-img .placeholder { display: none; }

    /* --- ë³„ì  (ì‚¬ì´ì¦ˆ UP) --- */
    .rating-wrapper {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-top: 10px;
    }
    
    .rating {
        display: inline-flex;
        flex-direction: row-reverse; 
        gap: 8px;
        border: 0;
        padding: 0;
        margin: 0;
    }

    .rating input { display: none; }

    .rating label {
        cursor: pointer;
        font-size: 42px; /* ë³„ í¬ê¸° ëŒ€í­ í™•ëŒ€ (28px -> 42px) */
        color: #e5e7eb; 
        margin: 0;
        line-height: 1;
        transition: color 0.2s;
    }

    .rating input:checked ~ label,
    .rating label:hover,
    .rating label:hover ~ label {
        color: rgb(255, 193, 7); /* ë°ì€ ë…¸ë€ìƒ‰/ê¸ˆìƒ‰ */
    }

    /* --- íŒŒì¼ ì—…ë¡œë“œ (ì‚¬ì´ì¦ˆ UP) --- */
    .uploader {
        border: none;
        padding: 0;
        margin: 0;
        position: relative;
    }
    
    .file-input-wrapper {
        position: relative;
        width: 100%;
        height: 140px; /* ì—…ë¡œë“œ ë°•ìŠ¤ ë†’ì´ í™•ëŒ€ */
        border: 2px dashed #cdd3db;
        border-radius: 14px;
        background: #fbfbfd;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: background 0.2s;
    }
    
    .file-input-wrapper:hover {
        background: #f4f6fb;
    }

    .file-input-wrapper input[type="file"] {
        position: absolute;
        width: 100%;
        height: 100%;
        opacity: 0;
        cursor: pointer;
    }

    .drop-hint { font-size: 16px; color: #6b7280; font-weight: 600; }
    .sub { font-size: 14px; color: #9ca3af; margin-top: 5px; }

    /* --- í•˜ë‹¨ ë²„íŠ¼ (ì‚¬ì´ì¦ˆ UP) --- */
    .actions {
        display: flex;
        justify-content: flex-end;
        gap: 15px;
        margin-top: 40px;
    }

    .btn {
        padding: 16px 32px; /* ë²„íŠ¼ í¬ê¸° í™•ëŒ€ */
        border-radius: 12px;
        font-size: 18px; /* ë²„íŠ¼ ê¸€ì”¨ í™•ëŒ€ */
        font-weight: bold;
        cursor: pointer;
        border: 1px solid var(--border);
        transition: all 0.2s;
    }

    .btn.ghost {
        background: white;
        color: #555;
    }
    .btn.ghost:hover { background: #f1f1f1; }

    .btn.primary {
        background: var(--primary);
        color: #fff;
        border-color: var(--primary);
    }
    .btn.primary:hover { 
        filter: brightness(0.9);
        transform: translateY(-2px);
    }

    /* ë°˜ì‘í˜• */
    @media (max-width: 900px) {
        .grid { grid-template-columns: 1fr; gap: 30px; }
        textarea { min-height: 300px; }
        .review-container { padding: 30px 20px; }
        .card { padding: 30px; }
    }
</style>
{% endblock style %}

{% block section %}
<div class="review-container">
    <a class="back-link" href="/review">â† ë¦¬ë·° ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    <h1 class="page-title">ë¦¬ë·° ë“±ë¡ (Add New Review)</h1>

    <form class="card" name="myform" id="myform" method="post" action="/reg_review" enctype="multipart/form-data">
        
        <div class="grid">
            <div class="col">
                
                <div id="imageBox" class="product-thumb">
                    <img id="thumbImg" alt="ìƒí’ˆ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°" />
                    <span class="placeholder">ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° (No Image)</span>
                </div>

                <div>
                    <label for="productName">ì œí’ˆëª… (Product Name)</label>
                    <input type="text" name="name" id="productName" value="{{name}}" readonly>
                </div>

                <div class="rating-wrapper">
                    <label style="margin-bottom:0;">í‰ì </label>
                    <div class="rating">
                        <input type="radio" name="reviewStar" value="5" id="rate5"><label for="rate5" title="5ì ">â˜…</label>
                        <input type="radio" name="reviewStar" value="4" id="rate4"><label for="rate4" title="4ì ">â˜…</label>
                        <input type="radio" name="reviewStar" value="3" id="rate3"><label for="rate3" title="3ì ">â˜…</label>
                        <input type="radio" name="reviewStar" value="2" id="rate2"><label for="rate2" title="2ì ">â˜…</label>
                        <input type="radio" name="reviewStar" value="1" id="rate1" checked><label for="rate1" title="1ì ">â˜…</label>
                    </div>
                </div>

                <div>
                    <label for="reviewTitle">ë¦¬ë·° ì œëª© (Title)</label>
                    <input type="text" name="title" id="reviewTitle" placeholder="ë¦¬ë·° ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>

                <fieldset class="uploader">
                    <label>ì‚¬ì§„ ì²¨ë¶€ (Image Upload)</label>
                    <div class="file-input-wrapper">
                        <input type="file" name="file" id="file" required>
                        <span class="drop-hint">ğŸ“¸ ì‚¬ì§„ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì„¸ìš”</span>
                        <span class="sub">ëŒ€í‘œ ì´ë¯¸ì§€ 1ì¥ì„ ì„ íƒí•´ì£¼ì„¸ìš”</span>
                    </div>
                </fieldset>
            </div>

            <div class="col">
                <label for="reviewBody">ë¦¬ë·° ë‚´ìš© (Content)</label>
                <textarea name="reviewContents" id="reviewBody" placeholder="ìƒí’ˆì— ëŒ€í•œ ì†”ì§í•œ ë¦¬ë·°ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”!"></textarea>
            </div>
        </div>

        <div class="actions">
            <button type="button" class="btn ghost" onclick="history.back();">ì·¨ì†Œ</button>
            <button type="submit" class="btn primary">ë¦¬ë·° ë“±ë¡í•˜ê¸°</button>
        </div>

    </form>
</div>

<script>
    const fileInput = document.getElementById('file');
    const thumbBox = document.getElementById('imageBox');
    const thumbImg = document.getElementById('thumbImg');
    const dropHint = document.querySelector('.drop-hint');

    fileInput.addEventListener('change', function(event) {
        const file = event.target.files[0];
        
        if (file) {
            // 1. FileReaderë¥¼ í†µí•´ ì´ë¯¸ì§€ ì½ê¸°
            const reader = new FileReader();
            reader.onload = function(e) {
                thumbImg.src = e.target.result;
                thumbBox.classList.add('has-img'); 
            }
            reader.readAsDataURL(file);

            // 2. ì—…ë¡œë“œ ë°•ìŠ¤ í…ìŠ¤íŠ¸ ë³€ê²½
            dropHint.textContent = "âœ… " + file.name;
            dropHint.style.color = "rgb(0, 70, 42)";
            dropHint.style.fontWeight = "bold";
        }
    });
</script>
{% endblock section %}